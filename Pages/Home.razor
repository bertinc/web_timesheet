@page "/"
@using System.Net.Http.Json
@using System.Threading.Tasks
@using System.Text.Json
@inject HttpClient Http
@inject IJSRuntime JsRuntime
@using TimeSheet.Models

<PageTitle>Home</PageTitle>

<div class="app">
    <header class="header">Time Sheet 2.0</header>

    <div class="main">
        <aside class="toolbar">
            <nav>
                <ul>
                    <li><a href="categories">Edit Categories</a></li>
                    <li><a href="companies">Edit Companies</a></li>
                    <li><a href="projects">Edit Projects</a></li>
                    <li>
                        <label for="start">Search Range:</label>
                        <input id="start" type="date" @bind-value="start" @bind-value:after="GetEntries" />
                        - <input id="end" type="date" @bind-value="end" @bind-value:after="GetEntries" />
                        <button @onclick="SetToday" style="margin-left: 5px;">Today</button>
                        <button @onclick="SetCurrentWeek" style="margin-left: 5px;">Week</button>
                        <button @onclick="SetCurrentMonth" style="margin-left: 5px;">Month</button>
                    </li>
                    <li>
                        <label style="float:left" for="date">Day:</label>
                        <input id="date" type="date" @bind="date" />
                    </li>
                    <li>
                        <label style="float:left" for="time">Time:</label>
                        <input id="time" type="time" @bind="time" />
                        <button @onclick="SnapToNow" style="margin-left: 5px;">Now</button>
                    </li>
                    <li>
                        <label style="float:left" for="hrs">Enter Hours:</label>
                        <input @ref="inputHours" id="hrs" type="number" min="0" max="24" step="0.25" @bind="hours" />
                    </li>
                    <li>
                        <label for="cmt">Comment:</label>
                        <textarea id="cmt" rows="2" @bind="comment" class="w-100"></textarea>
                    </li>
                    <li>
                        <label for="category">Category:</label>
                        <select id="category" @bind="selectedCategoryId" @bind:after="GetEntries">
                            <option value="0" selected>None</option>
                            @foreach (var c in categories.Categories ?? new List<Category>())
                            {
                                <option value="@c.Id">@c.Code</option>
                            }
                        </select>
                    </li>
                    <li>
                        <label for="company">Company:</label>
                        <select id="company" @bind="selectedCompanyId" @bind:after="GetEntries">
                            <option value="0" selected>None</option>
                            @foreach (var comp in companies.Companies ?? new List<Company>())
                            {
                                <option value="@comp.Id">@comp.Name</option>
                            }
                        </select>
                    </li>
                    <li>
                        <label for="project">Project:</label>
                        <select id="project" @bind="selectedProjectId" @bind:after="GetEntries">
                            <option value="0" selected>None</option>
                            @foreach (var proj in projects.Projects ?? new List<Project>())
                            {
                                @if (selectedCompanyId == 0 || proj.CompanyId == null || proj.CompanyId == selectedCompanyId)
                                {
                                    <option value="@proj.Id">@proj.Name</option>
                                }
                            }
                        </select>
                    </li>
                    <li>
                        <label style="float:left; vertical-align:middle;" for="billable">Billable:</label>
                        <input id="billable" type="checkbox" @bind="billable" @bind:after="GetEntries" />
                    </li>
                    <li>
                        <label for="details">Notes:</label>
                        <textarea id="details" rows="4" @bind="details" class="w-100"></textarea>
                    </li>
                    <li><button @onclick="AddEntry">Add Entry</button> <button @onclick="GetReport">Download Report</button></li>
                    <li>
                        Report @DateTime.Now.AddMonths(-1).ToString("MMM") hours by @GetFirstTuesday(DateTime.Now).ToString("MMM dd")
                    </li>
                    <li>
                        Report @DateTime.Now.ToString("MMM") hours by @GetFirstTuesday(DateTime.Now.AddMonths(1)).ToString("MMM dd")
                    </li>
                </ul>
            </nav>
        </aside>

        <section class="content">
            <h3>Search Results</h3>
            @if (SearchResults.Entries != null)
            {
                <table class="results_table" id="entries">
                    <thead>
                        <tr>
                            @* <th>ID</th> *@
                            <th>Date</th>
                            <th>Start</th>
                            <th>End</th>
                            <th>Minutes</th>
                            <th>Description</th>
                            <th>Category</th>
                            <th>Company</th>
                            <th>Project</th>
                            @* <th>Notes</th> *@
                            <th colspan="1">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var entry in SearchResults.Entries)
                        {
                            <tr @onclick="@(() => OpenEditModal(entry))" style="cursor: pointer;">
                                @* <td>@entry.Id</td> *@
                                <td>@entry.EntryDate</td>
                                <td>@FormatTime(entry.StartTime)</td>
                                <td>@FormatTime(entry.EndTime)</td>
                                <td>@entry.DurationMinutes</td>
                                <td class="small">@entry.Description</td>
                                <td>@entry.CategoryCode</td>
                                <td>@entry.CompanyName</td>
                                <td>@entry.ProjectCode</td>
                                @* <td class="small">@entry.Notes</td> *@
                                <td><button @onclick="@(() => RemoveEntry(@entry.Id))" @onclick:stopPropagation="true">Remove</button></td>
                            </tr>
                        }
                        @if (HoursPayResults != null)
                        {
                            <tr>
                                <td colspan="100">Total Hours: @HoursPayResults.Hours for Pay: @HoursPayResults.Pay.ToString("C")</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </section>
    </div>

    <footer class="footer">
        <label hidden="@hide_it">@label_text</label>
    </footer>
</div>

@if (showEditModal)
{
    <div class="modal-backdrop" @onclick="CloseEditModal">
        <div class="modal-content" @onclick:stopPropagation="true">
            <h3>Edit Entry #@editingEntry.Id</h3>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-date">Day:</label>
                    <input id="edit-date" type="date" @bind="editingEntry.EntryDate" />
                </div>
                <div class="form-group">
                    <label for="edit-time">Start Time:</label>
                    <input id="edit-time" type="time" @bind="editingEntry.StartTime" />
                </div>
                <div class="form-group">
                    <label for="edit-minutes">Duration (minutes):</label>
                    <input id="edit-minutes" type="number" @bind="editingEntry.DurationMinutes" min="0" step="15" />
                </div>
                <div class="form-group">
                    <label for="edit-description">Description:</label>
                    <textarea id="edit-description" rows="2" @bind="editingEntry.Description"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-category">Category:</label>
                    <select id="edit-category" @bind="editingEntry.CategoryId">
                        <option value="0">None</option>
                        @foreach (var c in categories.Categories ?? new List<Category>())
                        {
                            <option value="@c.Id">@c.Code</option>
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-company">Company:</label>
                    <select id="edit-company" @bind="editingEntry.CompanyId">
                        <option value="0">None</option>
                        @foreach (var comp in companies.Companies ?? new List<Company>())
                        {
                            <option value="@comp.Id">@comp.Name</option>
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-project">Project:</label>
                    <select id="edit-project" @bind="editingEntry.ProjectId">
                        <option value="0">None</option>
                        @foreach (var proj in projects.Projects ?? new List<Project>())
                        {
                            <option value="@proj.Id">@proj.Name</option>
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-billable">Billable:</label>
                    <input id="edit-billable" type="checkbox" @bind="editingEntry.Billable" />
                </div>
                <div class="form-group">
                    <label for="edit-notes">Notes:</label>
                    <textarea id="edit-notes" rows="3" @bind="editingEntry.Notes"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button @onclick="SaveEditedEntry">Save</button>
                <button @onclick="CloseEditModal">Cancel</button>
            </div>
        </div>
    </div>
}

@code {
    private ElementReference inputHours;
    private bool hide_it = true;
    private string label_text = "Some Text";
    private DateTime date = DateTime.Now.Date;
    private DateTime start = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1);
    private DateTime end = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1).AddMonths(1).AddDays(-1);
    private TimeOnly time = TimeOnly.FromDateTime(DateTime.Now.Date.AddHours(7));
    private float hours = 0;
    private bool billable = true;
    private string comment = string.Empty;
    private string details = string.Empty;
    private int entryIdToRemove = 0;
    
    private bool showEditModal = false;
    private EditEntryModel editingEntry = new EditEntryModel();
    
    private string api_base = "http://10.0.0.192:8001/";
    private string get_cats_endpont = "categories";
    private string get_comp_endpont = "companies";
    private string get_proj_endpont = "projects";
    private string get_entries_endpoint = "getentries";
    private string add_entry_endpoint = "addentry";
    private string update_entry_endpoint = "updateentry";
    private string remove_entry_endpoint = "removeentry";
    private string get_hours_pay_endpoint = "gethoursandpay";
    private string api_url = "http://10.0.0.192:8001/addrow";
    private CategoriesResponse categories = new CategoriesResponse();
    private CompaniesResponse companies = new CompaniesResponse();
    private ProjectsResponse projects = new ProjectsResponse();
    private GetEntriesResponse SearchResults = new GetEntriesResponse();
    private AddEntryResponse InsertResults = new AddEntryResponse();
    private GetHoursAndPayResponse HoursPayResults = new GetHoursAndPayResponse();
    // Selected category id from the <select>
    private int? selectedCategoryId;
    // Selected company id from the <select>
    private int? selectedCompanyId;
    // Selected project id from the <select>
    private int? selectedProjectId;

    // Set the code you want auto-selected here
    private string autoSelectCategoryCode = "DEV";
    private string autoSelectCompanyName = "Wasatch Photonics";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        // execute conditionally for loading data, otherwise this will load
        // every time the page refreshes
        if (firstRender)
        {
            await GetCategories();
            await GetCompanies();
            await GetProjects();
            await inputHours.FocusAsync();
            await GetEntries();
            StateHasChanged();
        }
    }

    public async Task GetCategories()
    {
        var resp = await Http.GetAsync(api_base + get_cats_endpont);
        if (resp.IsSuccessStatusCode)
        {
            categories = await resp.Content.ReadFromJsonAsync<CategoriesResponse>();

            // Auto-select category by code (set autoSelectCategoryCode above)
            selectedCategoryId = categories.Categories?
                .FirstOrDefault(c => string.Equals(c.Code, autoSelectCategoryCode, StringComparison.OrdinalIgnoreCase))
                ?.Id ?? 0;
        }
    }

    public async Task GetCompanies()
    {
        var resp = await Http.GetAsync(api_base + get_comp_endpont);
        if (resp.IsSuccessStatusCode)
        {
            companies = await resp.Content.ReadFromJsonAsync<CompaniesResponse>();

            // Auto-select company by name (set autoSelectCompanyName above)
            selectedCompanyId = companies.Companies?
                .FirstOrDefault(c => string.Equals(c.Name, autoSelectCompanyName, StringComparison.OrdinalIgnoreCase))
                ?.Id ?? 0;
        }
    }

    public async Task GetProjects()
    {
        var resp = await Http.GetAsync(api_base + get_proj_endpont);
        if (resp.IsSuccessStatusCode)
        {
            projects = await resp.Content.ReadFromJsonAsync<ProjectsResponse>();
        }
    }

    public async Task GetEntries()
    {

        SearchParams searchParams = new SearchParams
        {
            Start = Uri.EscapeDataString(start.ToString("yyyy-MM-dd")),
            End = Uri.EscapeDataString(end.ToString("yyyy-MM-dd")),
            Company = selectedCompanyId != 0 ? selectedCompanyId : null,
            Category = selectedCategoryId != 0 ? selectedCategoryId : null,
            Project = selectedProjectId != 0 ? selectedProjectId : null
        };

        try
        {
            var queryParams = new List<string>
            {
                $"start={searchParams.Start}",
                $"end={searchParams.End}"
            };

            if (searchParams.Company.HasValue)
                queryParams.Add($"company_id={searchParams.Company.Value}");
            if (searchParams.Category.HasValue)
                queryParams.Add($"category_id={searchParams.Category.Value}");
            if (searchParams.Project.HasValue)
                queryParams.Add($"project_id={searchParams.Project.Value}");

            var queryString = string.Join("&", queryParams);
            var url = $"{api_base}{get_entries_endpoint}?{queryString}";

            var resp = await Http.GetAsync(url);
            var content = await resp.Content.ReadAsStringAsync();
            if (resp.IsSuccessStatusCode)
            {
                SearchResults = await resp.Content.ReadFromJsonAsync<GetEntriesResponse>();
                label_text = $"Found {SearchResults.Entries?.Count ?? 0} entries.";
            }
            else
            {
                label_text = $"Error: {resp.StatusCode} - {content}";
            }
        }
        catch (Exception ex)
        {
            label_text = $"Error building query: {ex.Message}";
            hide_it = false;
            return;
        }
        hide_it = false;
        await GetHoursAndPay();
    }

    private async Task GetHoursAndPay()
    {
        HoursPayResults = new GetHoursAndPayResponse(); // Clear previous results

        SearchParams searchParams = new SearchParams
        {
            Start = Uri.EscapeDataString(start.ToString("yyyy-MM-dd")),
            End = Uri.EscapeDataString(end.ToString("yyyy-MM-dd")),
            Company = selectedCompanyId != 0 ? selectedCompanyId : null,
            Category = selectedCategoryId != 0 ? selectedCategoryId : null,
            Project = selectedProjectId != 0 ? selectedProjectId : null
        };

        if (!searchParams.Company.HasValue)
        {
            label_text = "Please select a company to view hours and pay.";
            hide_it = false;
            return;
        }

        try
        {
            var queryParams = new List<string>
            {
                $"start={searchParams.Start}",
                $"end={searchParams.End}"
            };

            if (searchParams.Company.HasValue)
                queryParams.Add($"company_id={searchParams.Company.Value}");
            if (searchParams.Category.HasValue)
                queryParams.Add($"category_id={searchParams.Category.Value}");
            if (searchParams.Project.HasValue)
                queryParams.Add($"project_id={searchParams.Project.Value}");

            var queryString = string.Join("&", queryParams);
            var url = $"{api_base}{get_hours_pay_endpoint}?{queryString}";

            var resp = await Http.GetAsync(url);
            var content = await resp.Content.ReadAsStringAsync();
            if (resp.IsSuccessStatusCode)
            {
                HoursPayResults = await resp.Content.ReadFromJsonAsync<GetHoursAndPayResponse>();
                //label_text = $"Total Hours: {HoursPayResults.Hours}, Total Pay: {HoursPayResults.Pay:C}";
                StateHasChanged();

            }
            else
            {
                label_text = $"Error: {resp.StatusCode} - {content}";
            }
        }
        catch (Exception ex)
        {
            label_text = $"Error building query: {ex.Message}";
            hide_it = false;
            return;
        }
    }

    private async Task GetReport()
    {
        if (SearchResults.Entries == null || SearchResults.Entries.Count == 0)
        {
            label_text = "No entries to download.";
            hide_it = false;
            return;
        }

        try
        {
            var csv = GenerateCsv(SearchResults.Entries, HoursPayResults);
            var bytes = System.Text.Encoding.UTF8.GetBytes(csv);
            
            await JsRuntime.InvokeVoidAsync("downloadFile", 
                Convert.ToBase64String(bytes), 
                "text/csv", 
                $"timesheet_{DateTime.Now:yyyy-MM-dd_HHmmss}.csv");
            
            label_text = "Report downloaded successfully.";
            hide_it = false;
        }
        catch (Exception ex)
        {
            label_text = $"Error generating report: {ex.Message}";
            hide_it = false;
        }
    }

    private string GenerateCsv(List<Entry> entries, GetHoursAndPayResponse hoursPayResults)
    {
        var sb = new System.Text.StringBuilder();
        
        sb.AppendLine("Date,Start,Minutes,Description,Category,Project");
        
        foreach (var entry in entries)
        {
            var description = EscapeCsvField(entry.Description);
            var category = EscapeCsvField(entry.CategoryCode);
            var project = EscapeCsvField(entry.ProjectCode);
            
            sb.AppendLine($"{entry.EntryDate},{entry.StartTime},{entry.DurationMinutes},{description},{category},{project}");
        }
        
        sb.AppendLine();
        
        if (hoursPayResults != null)
        {
            sb.AppendLine($"Total Hours,{hoursPayResults.Hours}");
        }
        
        return sb.ToString();
    }

    private string EscapeCsvField(string value)
    {
        if (string.IsNullOrEmpty(value))
            return "\"\"";
        
        // Always quote fields and escape internal quotes by doubling them
        return "\"" + value.Replace("\"", "\"\"") + "\"";
    }

    private DateTime GetFirstTuesday(DateTime dateInMonth)
    {
        var firstOfMonth = new DateTime(dateInMonth.Year, dateInMonth.Month, 1);
        
        while (firstOfMonth.DayOfWeek != DayOfWeek.Tuesday)
        {
            firstOfMonth = firstOfMonth.AddDays(1);
        }
        
        return firstOfMonth;
    }

    private async Task AddEntry()
    {
        var entryParams = new InsertEntryParams
        {
            entry_date = date.ToString("yyyy-MM-dd"),
            start_time = time.ToString("HH:mm"),
            duration_minutes = (int)(hours * 60),
            billable = billable ? 1 : 0,
            description = comment,
            category_id = selectedCategoryId != 0 ? selectedCategoryId : null,
            company_id = selectedCompanyId != 0 ? selectedCompanyId : null,
            project_id = selectedProjectId != 0 ? selectedProjectId : null,
            notes = details
        };

        var json = JsonSerializer.Serialize(entryParams);
        var content = new StringContent(json, System.Text.Encoding.UTF8, "application/json");

        try
        {
            var resp = await Http.PostAsync(api_base + add_entry_endpoint, content);
            var respContent = await resp.Content.ReadAsStringAsync();
            if (resp.IsSuccessStatusCode)
            {
                InsertResults = JsonSerializer.Deserialize<AddEntryResponse>(respContent, new JsonSerializerOptions { PropertyNameCaseInsensitive = true }) ?? new AddEntryResponse();
                label_text = $"Entry added with ID: {InsertResults.Inserted}";
            }
            else
            {
                label_text = $"Error: {resp.StatusCode} - {InsertResults.Error}";
            }
        }
        catch (Exception ex)
        {
            label_text = $"Error adding entry: {ex.Message}";
        }

        await GetEntries();
        comment = string.Empty;
        details = string.Empty;
        hours = 0;
    }

    private async Task UpdateEntry(int entryId, string entryDate, string startTime, int durationMinutes, 
        int billableValue, string description, int? categoryId, int? companyId, int? projectId, string notes)
    {
        var updateParams = new UpdateEntryParams
        {
            id = entryId,
            entry_date = entryDate,
            start_time = startTime,
            duration_minutes = durationMinutes,
            billable = billableValue,
            description = description,
            category_id = categoryId,
            company_id = companyId,
            project_id = projectId,
            notes = notes
        };

        var json = JsonSerializer.Serialize(updateParams);
        var content = new StringContent(json, System.Text.Encoding.UTF8, "application/json");

        try
        {
            var resp = await Http.PostAsync(api_base + update_entry_endpoint, content);
            var respContent = await resp.Content.ReadAsStringAsync();
            if (resp.IsSuccessStatusCode)
            {
                label_text = $"Entry {entryId} updated successfully.";
            }
            else
            {
                label_text = $"Error updating entry: {resp.StatusCode} - {respContent}";
            }
        }
        catch (Exception ex)
        {
            label_text = $"Error updating entry: {ex.Message}";
        }

        hide_it = false;
        await GetEntries();
    }

    private async Task RemoveEntry(int rem_id = 0)
    {
        if (rem_id != 0)
        {
            entryIdToRemove = rem_id;
        }

        if (entryIdToRemove == 0)
        {
            label_text = "Please enter a valid entry ID to remove.";
            hide_it = false;
            return;
        }

        bool confirmed = await JsRuntime.InvokeAsync<bool>("confirm", $"Are you sure you want to delete entry ID {entryIdToRemove}?");

        if (!confirmed)
        {
            return;
        }

        var payload = new { id = entryIdToRemove };
        var json = JsonSerializer.Serialize(payload);
        var content = new StringContent(json, System.Text.Encoding.UTF8, "application/json");

        try
        {
            var resp = await Http.PostAsync(api_base + "removeentry", content);
            var respContent = await resp.Content.ReadAsStringAsync();
            if (resp.IsSuccessStatusCode)
            {
                label_text = $"Entry with ID {entryIdToRemove} removed.";
            }
            else
            {
                label_text = $"Error: {resp.StatusCode} - {respContent}";
            }
        }
        catch (Exception ex)
        {
            label_text = $"Error removing entry: {ex.Message}";
        }

        await GetEntries();
    }

    private void OpenEditModal(Entry entry)
    {
        editingEntry = new EditEntryModel
        {
            Id = entry.Id,
            EntryDate = DateTime.Parse(entry.EntryDate),
            StartTime = TimeOnly.Parse(entry.StartTime),
            DurationMinutes = entry.DurationMinutes,
            Description = entry.Description ?? string.Empty,
            CategoryId = entry.CategoryId ?? 0,
            CompanyId = entry.CompanyId ?? 0,
            ProjectId = entry.ProjectId ?? 0,
            Billable = entry.Billable == 1,
            Notes = entry.Notes ?? string.Empty
        };
        showEditModal = true;
    }

    private void CloseEditModal()
    {
        showEditModal = false;
    }

    private async Task SaveEditedEntry()
    {
        await UpdateEntry(
            editingEntry.Id,
            editingEntry.EntryDate.ToString("yyyy-MM-dd"),
            editingEntry.StartTime.ToString("HH:mm"),
            editingEntry.DurationMinutes,
            editingEntry.Billable ? 1 : 0,
            editingEntry.Description,
            editingEntry.CategoryId != 0 ? editingEntry.CategoryId : null,
            editingEntry.CompanyId != 0 ? editingEntry.CompanyId : null,
            editingEntry.ProjectId != 0 ? editingEntry.ProjectId : null,
            editingEntry.Notes
        );
        CloseEditModal();
    }

    private async Task SnapToNow()
    {
        var now = DateTime.Now;
        var minutes = now.Minute;
        var roundedMinutes = (int)Math.Round(minutes / 15.0) * 15;
        
        var snappedTime = now.AddMinutes(roundedMinutes - minutes);
        
        date = snappedTime.Date;
        time = TimeOnly.FromDateTime(snappedTime);
    }

    private async Task SetToday()
    {
        var today = DateTime.Now.Date;
        start = today;
        end = today;
        await GetEntries();
    }

    private async Task SetCurrentWeek()
    {
        var today = DateTime.Now.Date;
        var daysToMonday = (int)today.DayOfWeek - 1;
        var monday = today.AddDays(-daysToMonday);
        var sunday = monday.AddDays(6);
        
        start = monday;
        end = sunday;
        await GetEntries();
    }

    private async Task SetCurrentMonth()
    {
        var today = DateTime.Now.Date;
        var firstDayOfMonth = new DateTime(today.Year, today.Month, 1);
        var lastDayOfMonth = firstDayOfMonth.AddMonths(1).AddDays(-1);
        
        start = firstDayOfMonth;
        end = lastDayOfMonth;
        await GetEntries();
    }

    private string FormatTime(string timeString)
    {
        if (string.IsNullOrEmpty(timeString))
            return "-";
        
        try
        {
            // Check if it contains a space (likely datetime format like "2024-01-15 14:30:00")
            if (timeString.Contains(" "))
            {
                // Extract just the time portion
                var timePortion = timeString.Split(" ")[1];
                var time = TimeOnly.Parse(timePortion);
                return time.ToString("h:mm tt");
            }
            else
            {
                // Try parsing as just time (HH:mm or HH:mm:ss)
                var time = TimeOnly.Parse(timeString);
                return time.ToString("h:mm tt");
            }
        }
        catch
        {
            return timeString;
        }
    }

    public class SearchParams
    {
        public string Start { get; set; } = DateTime.Now.ToString("yyyy-MM-dd");
        public string End { get; set; } = DateTime.Now.AddDays(7).ToString("yyyy-MM-dd");
        public int? Company { get; set; }
        public int? Category { get; set; }
        public int? Project { get; set; }
    }

    public class InsertEntryParams
    {
        public string entry_date { get; set; } = DateTime.Now.ToString("yyyy-MM-dd");
        public string start_time { get; set; } = DateTime.Now.ToString("HH:mm");
        public int duration_minutes { get; set; } = 0;
        public int billable { get; set; } = 1;
        public string? description { get; set; }
        public int? category_id { get; set; }
        public int? company_id { get; set; }
        public int? project_id { get; set; }
        public string? notes { get; set; }
    }

    public class UpdateEntryParams
    {
        public int id { get; set; }
        public string entry_date { get; set; } = DateTime.Now.ToString("yyyy-MM-dd");
        public string start_time { get; set; } = DateTime.Now.ToString("HH:mm");
        public int duration_minutes { get; set; } = 0;
        public int billable { get; set; } = 1;
        public string? description { get; set; }
        public int? category_id { get; set; }
        public int? company_id { get; set; }
        public int? project_id { get; set; }
        public string? notes { get; set; }
    }

    public class EditEntryModel
    {
        public int Id { get; set; }
        public DateTime EntryDate { get; set; }
        public TimeOnly StartTime { get; set; }
        public int DurationMinutes { get; set; }
        public string Description { get; set; } = string.Empty;
        public int CategoryId { get; set; }
        public int CompanyId { get; set; }
        public int ProjectId { get; set; }
        public bool Billable { get; set; }
        public string Notes { get; set; } = string.Empty;
    }
}